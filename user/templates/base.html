{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#317EFB" />
  <meta name="color-scheme" content="light dark">
  <title>{% block title %}提比資產管理系統{% endblock %}</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
  <!-- jquery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-nightshade.min.css"
    rel="stylesheet">
  <!-- 黑暗 https://github.com/vinorodrigues/bootstrap-dark-5 -->

  <meta name="description" content="提比資產管理系統" />
  <link rel="shortcut icon" type="image/png" href="{% static 'user/img/hm_smile.png' %}" />
  <link rel="stylesheet" href="{% static 'user/css/main.css' %}" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <style type="text/css">
    .d-light-inline {
      display: inline !important;
    }

    .d-dark-inline {
      display: none !important;
    }

    html.dark .d-light-inline {
      display: none !important;
    }

    html.dark .d-dark-inline {
      display: inline !important;
    }

    html.light .navbar {
      background-color: aliceblue;
    }

    html.dark .navbar {
      background-color: rgb(8, 27, 46);
    }
  </style>
</head>

<body>

  <!-- 互動視窗 紀錄分寶 -->
  <div class="modal fade" id="receipt_view" tabindex="-1" aria-labelledby="receipt_view_label" aria-hidden="true">
    <div class="modal-dialog" id="set_view_modal">
    </div>
  </div>

  <div class="layout has-sidebar fixed-sidebar fixed-header">
    <aside id="sidebar" class="sidebar break-point-lg has-bg-image">
      <div class="image-wrapper">
        <img src="{% static 'user/img/sidebar-bg.jpg' %}" alt="sidebar background" />
      </div>

      <div class="sidebar-layout">
        <a href="/" class="text-reset">
          <div class="sidebar-header">
            <span style="
                text-transform: uppercase;
                font-size: 20px;
                letter-spacing: 3px;
                font-weight: bold;
              ">提比資產管理系統</span>
          </div>
        </a>

        <div class="sidebar-content">
          <nav class="menu open-current-submenu">
            <ul>
              <li class="menu-item sub-menu open">
                <a href="#">
                  <span class="menu-icon">
                    <i class="bi bi-suit-diamond-fill"></i>
                  </span>
                  <span class="menu-title">新瑪英</span>
                </a>
                <div class="sub-menu-list" id="group_info">
                  <!-- 寫入分寶群清單 -->
                </div>
              </li>
              <li class="menu-item">
                <a href="#">
                  <span class="menu-icon">
                    <i class="bi bi-book-fill"></i>
                  </span>
                  <span class="menu-title">其他</span>
                </a>
              </li>

              {% if request.user.is_staff %}
              <li>
                <hr class="dropdown-divider">
              </li>
              <li class="menu-item">
                <a href="/admin/">
                  <span class="menu-icon">
                    <i class="bi bi-door-closed-fill"></i>
                  </span>
                  <span class="menu-title">進入後台</span>
                </a>
              </li>
              {% endif %}

            </ul>
          </nav>
        </div>
        <div class="sidebar-footer"><span>建置中...</span></div>
      </div>
    </aside>
    <div id="overlay" class="overlay"></div>
    <div class="layout">

      <nav class="navbar navbar-expand navbar-light sticky-top">
        <div class="container-fluid">

          <a id="btn-collapse" href="#" class="break-point-lg">
            <i class="bi bi-list" style="font-size: 2rem;"></i>
          </a>
          <a id="btn-toggle" href="#" class="sidebar-toggler break-point-lg">
            <i class="bi bi-list" style="font-size: 2rem;"></i>
          </a>

          <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <div class="container-fluid">
                <span class="navbar-text">
                  <!-- 標題 -->
                </span>
              </div>
            </ul>

            <div class="d-flex">
              <a id="darkmode-button" class="btn">
                <i class="bi bi-moon-stars d-light-inline" style="font-size: 1.4rem;"></i>
                <i class="bi bi-sun-fill d-dark-inline" style="font-size: 1.4rem;"></i>
              </a>
              {% if user.is_authenticated %}
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    {% if user.userprofile.avatar %}
                    <img src="{{ user.userprofile.avatar.url }}" class="sticky-top rounded-pill"
                      style="width: 30px; height: 30px">
                    {% else %}
                    <img src="https://secure.gravatar.com/avatar/{{ user.userprofile.user_token.hex }}?s=30&d=identicon"
                      class="sticky-top rounded-pill" style="width: 30px; height: 30px">
                    {% endif %}
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                    <li><a class="dropdown-item" href="/accounts/password/change/">變更密碼</a></li>
                    <li><a class="dropdown-item" href="/accounts/email/">信箱驗證</a></li>
                    <li><a class="dropdown-item" href="/accounts/social/connections/">第三方連結</a></li>
                    <li>
                      <hr class="dropdown-divider">
                    </li>
                    <li><a class="dropdown-item" href="/accounts/logout/">登出</a></li>
                  </ul>
                </li>
              </ul>
              {% else %}
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item dropdown">
                  <a class="nav-link" href="/accounts/login/" style="font-size: 1.4rem;">
                    <i class="bi bi-person-fill"></i>
                    登入
                  </a>
                </li>
              </ul>
              {% endif %}
            </div>

          </div>
        </div>
      </nav>

      <main class="content">
        <!-- 內容區 -->
        {% block content %}{% endblock content %}
      </main>
      <div class="overlay"></div>
      {% if messages %}
      <div class="toast-container position-absolute p-3 bottom-0 end-0"
        data-original-class="toast-container position-absolute p-3">
        {% for message in messages %}
        <div class="toast fade show">
          <div class="toast-header">
            <i class="bi bi-chat"></i>
            <strong class="me-auto"> 帳號訊息:</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
          <div class="toast-body">
            {{message}}
          </div>
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>
</body>
<script src="{% static 'user/js/main.js' %}"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/js/darkmode.min.js"></script>

{% block script %}{% endblock script %}

{% if user.is_authenticated %}

<script>
</script>

{% else %}
<script>
  sessionStorage.clear()
</script>
{% endif %}

</html>